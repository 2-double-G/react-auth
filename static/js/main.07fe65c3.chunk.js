(this["webpackJsonpreact-auth"]=this["webpackJsonpreact-auth"]||[]).push([[0],{28:function(e,t,n){e.exports={Auth:"Auth_Auth__1axDc",error:"Auth_error__1USVn"}},29:function(e,t,n){e.exports={Input:"Input_Input__1Bbls",invalid:"Input_invalid__3RbeT"}},30:function(e,t,n){e.exports={Loader:"Loader_Loader__2jWZa","lds-dual-ring":"Loader_lds-dual-ring__1cYaw",mini:"Loader_mini__1U1f8"}},33:function(e,t,n){e.exports={Users:"Users_Users__2I87Z",input:"Users_input__nuGYU"}},34:function(e,t,n){e.exports={TableContainer:"Table_TableContainer__vF3O3",errorMessage:"Table_errorMessage__1BNqc"}},45:function(e,t,n){e.exports={Layout:"Layout_Layout__UZSCv"}},46:function(e,t,n){e.exports={Button:"Button_Button__2mkiV"}},59:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),o=n(19),c=n.n(o),s=n(14),i=n(18),u=(n(59),n(12)),l=n(13),d=n(16),h=n(15),p=n(4),j=n(45),b=n.n(j),f=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(r.jsx)("div",{className:b.a.Layout,children:Object(r.jsx)("main",{children:this.props.children})})}}]),n}(a.Component),O=n(3),v=n(28),m=n.n(v),g=n(29),_=n.n(g),x=function(e,t){return!e&&t},y=function(e,t,n){return x(e,t)?Object(r.jsx)("span",{children:n}):null},C=function(e){var t=e.addClass,n=e.type,a=e.label,o=e.value,c=e.onChange,s=e.errorMessage,i=e.valid,u=e.touched,l=[_.a.Input,t],d="".concat(n," - ").concat(Math.random());return x(i,u)&&l.push(_.a.invalid),Object(r.jsxs)("div",{className:l.join(" "),children:[Object(r.jsx)("label",{htmlFor:d,children:a}),Object(r.jsx)("input",{type:n,name:d,value:o,onChange:c}),y(i,u,s)]})};C.defaultProps={onChange:function(){},value:"",addClass:"",type:"text",label:"",errorMessage:"",valid:!0,touched:!1};var S=C,k=n(46),E=n.n(k),T=function(e){var t=e.disabled,n=e.onClick,a=e.children;return Object(r.jsx)("button",{className:E.a.Button,disabled:t,onClick:n,children:a})};T.defaultProps={onClick:function(){},disabled:!1};var U=T,w=n(22),L=n.n(w),N=n(24),A=n(25),F=n.n(A),H="AUTH_START",I="AUTH_SUCCESS",R="AUTH_ERROR",B="AUTH_LOGOUT",M="FETCH_USERS_START",D="FETCH_USERS_SUCCESS",V="FETCH_USERS_ERROR",P="GET_TOKEN",X="SEARCH_USERS",q="FILTER_USERS",G="SHOW_FORM_STATE",J="PUSH_BUTTON",W=function(){return{type:H}},Y=function(e){return{type:I,token:e}},Z=function(){return{type:R}},z=n(30),K=n.n(z),Q=function(e){var t=e.variant;return Object(r.jsx)("div",{className:K.a[t],children:Object(r.jsx)("div",{className:K.a.Loader})})},$=function(e,t,n){return{type:e,label:t,value:"",valid:!1,touched:!1,errorMessage:n,validation:{required:!0,minLength:1}}},ee=function(e,t){var n=!0;return e.minLength&&(n=n&&t.length>=e.minLength),e.required&&(n=n&&""!==t.trim()),n};function te(e){var t=!0;for(var n in e)e.hasOwnProperty(n)&&(t=e[n].valid&&t);return t}var ne=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).onSubmitHandler=function(e){e.preventDefault()},e.onChangeHandler=function(t,n){var r=e.props,a=r.isButtonTouched,o=r.changeFormState,c=Object(O.a)({},e.props.formState.inputControls),s=c[n];s.touched=!0,s.value=t.target.value,s.valid=ee(s.validation,s.value),c[n]=s,a(!1),o({isFormValid:te(c),inputControls:c})},e.loginHandler=function(){var t=e.props,n=t.auth,r=t.isButtonTouched,a=e.props.formState.inputControls.username.value,o=e.props.formState.inputControls.password.value;r(!0),n(a,o)},e}return Object(l.a)(n,[{key:"renderInput",value:function(){var e=this,t=Object(O.a)({},this.props.formState.inputControls);return Object.keys(t).map((function(n,a){var o=t[n],c=o.label,s=o.type,i=o.value,u=o.errorMessage,l=o.valid,d=o.touched;return Object(r.jsx)(S,{label:c,type:s,value:i,onChange:function(t){return e.onChangeHandler(t,n)},errorMessage:u,valid:l,touched:d},a)}))}},{key:"renderButton",value:function(){var e=this.props.loading,t=this.props.formState.isFormValid,n=e||!t;return Object(r.jsx)(U,{disabled:n,onClick:this.loginHandler,children:e?Object(r.jsx)(Q,{variant:"mini"}):"Login"})}},{key:"renderErrorMessage",value:function(e,t){return e&&t?Object(r.jsx)("span",{className:m.a.error,children:"Wrong username or password"}):null}},{key:"render",value:function(){var e=this.props,t=e.isAuthenticated,n=e.isError,a=this.props.formState.touchedButton;return t?Object(r.jsx)(p.a,{to:"/users"}):Object(r.jsx)("div",{className:m.a.Auth,children:Object(r.jsx)("div",{children:Object(r.jsxs)("form",{onSubmit:this.onSubmitHandler,children:[Object(r.jsx)("h1",{children:"Sign in"}),this.renderErrorMessage(n,a),this.renderInput(),this.renderButton()]})})})}}]),n}(a.Component),re=Object(s.b)((function(e){return{isAuthenticated:!!e.auth.token,isError:e.auth.isError,loading:e.auth.loading,formState:e.form}}),(function(e){return{auth:function(t,n){return e(function(e,t){return function(){var n=Object(N.a)(L.a.mark((function n(r){var a,o,c,s;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={username:e,password:t},r(W()),o=F.a.create({baseURL:"https://emphasoft-test-assignment.herokuapp.com"}),n.prev=4,n.next=7,o.post("api-token-auth/",a);case 7:c=n.sent,s=c.data,localStorage.setItem("token",s.token),r(Y(s.token)),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(4),console.error(n.t0),r(Z());case 17:case"end":return n.stop()}}),n,null,[[4,13]])})));return function(e){return n.apply(this,arguments)}}()}(t,n))},changeFormState:function(t){return e(function(e){var t=e.isFormValid,n=e.inputControls;return{type:G,isFormValid:t,inputControls:n}}(t))},isButtonTouched:function(t){return e({type:J,touchedButton:t})}}}))(ne),ae=n(94),oe=n(33),ce=n.n(oe),se=n(34),ie=n.n(se),ue=function(e){return e.map((function(e,t){return Object(r.jsx)("tr",{children:Object.keys(e).map((function(t,n){return Object(r.jsx)("td",{"data-heading":t,children:"".concat(e[t])},n)}))},t)}))},le=function(e){return e.map((function(e,t){return Object(r.jsx)("th",{children:e},t)}))},de=function(e){return"[]"===JSON.stringify(e)?Object(r.jsx)("span",{className:ie.a.errorMessage,children:"There is no such user"}):null},he=function(e){var t=e.data,n=e.headingColumns;return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("div",{className:ie.a.TableContainer,children:Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsx)("tr",{children:le(n)})}),Object(r.jsx)("tbody",{children:ue(t)})]})}),de(t)]})};he.defaultProps={data:[],headingColumns:[]};var pe=he,je=function(){return{type:M}},be=function(e){return{type:D,data:e}},fe=function(){return{type:V}},Oe=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).onChangeHandler=function(t){e.props.search(t.target.value)},e.sortClickHandler=function(){var t="asc"===e.props.order?"desc":"asc";e.props.filter(t)},e.renderUI=function(t,n){return Object(r.jsxs)("div",{children:[Object(r.jsx)(S,{addClass:ce.a.input,label:"Search username",value:t,onChange:e.onChangeHandler}),Object(r.jsxs)(U,{onClick:e.sortClickHandler,children:["Sort by Id",Object(r.jsx)(ae.a,{active:!0,direction:n})]}),Object(r.jsx)(i.b,{to:"/logout",children:"Logout"})]})},e.renderUsers=function(t,n,a,o){return Object(r.jsxs)("div",{children:[e.renderUI(t,n),Object(r.jsx)(pe,{data:a,headingColumns:o})]})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.users()}},{key:"render",value:function(){var e=this.props,t=e.usersData,n=e.order,a=e.searchName,o=t.sort((function(e,t){return e.id<t.id?"asc"===n?-1:1:e.id>t.id?"asc"===n?1:-1:0})).filter((function(e){return e.username.toLowerCase().includes(a.toLowerCase().trim(" "))}));return Object(r.jsx)("div",{className:ce.a.Users,children:this.props.loading?Object(r.jsx)(Q,{}):this.renderUsers(a,n,o,["id","username","first_name","last_name","is_active","last_login","is_superuser"])})}}]),n}(a.Component),ve=Object(s.b)((function(e){return{usersData:e.users.data,searchName:e.search,loading:e.users.loading,order:e.filter.direction}}),(function(e){return{users:function(){return e(function(){var e=Object(N.a)(L.a.mark((function e(t){var n,r,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("token"),t(je()),e.prev=3,e.next=6,F.a.get("https://emphasoft-test-assignment.herokuapp.com/api/v1/users/",{headers:{Authorization:"Token ".concat(n)}});case 6:r=e.sent,a=r.data.map((function(e){return{id:e.id,username:""!==e.username?e.username:"-",first_name:""!==e.first_name?e.first_name:"-",last_name:""!==e.last_name?e.last_name:"-",is_active:e.is_active?"Active":"Not active",last_login:e.last_login?new Date(e.last_login).toLocaleString():"Unknown",is_superuser:e.is_superuser?"Yes":"No"}})),t(be(a)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),t(fe()),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}())},search:function(t){return e({type:X,search:t})},filter:function(t){return e(function(e){return{type:q,order:e}}(t))}}}))(Oe),me=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.logout()}},{key:"render",value:function(){return Object(r.jsx)(p.a,{to:"/login"})}}]),n}(a.Component),ge=Object(s.b)(null,(function(e){return{logout:function(){return e((localStorage.removeItem("token"),{type:B}))}}}))(me),_e=n(48),xe=function(e){var t=e.component,n=e.auth,a=Object(_e.a)(e,["component","auth"]);return Object(r.jsx)(p.b,Object(O.a)(Object(O.a)({},a),{},{render:function(e){return!0===n?Object(r.jsx)(t,Object(O.a)({},e)):Object(r.jsx)(p.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},ye=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.isToken()}},{key:"render",value:function(){return Object(r.jsx)(f,{children:Object(r.jsxs)(p.d,{children:[Object(r.jsx)(p.b,{path:"/login",component:re}),Object(r.jsx)(p.b,{path:"/logout",component:ge}),Object(r.jsx)(xe,{path:"/users",component:ve,auth:this.props.isAuthenticated}),Object(r.jsx)(p.a,{from:"/",to:"/login"})]})})}}]),n}(a.Component),Ce=Object(p.g)(Object(s.b)((function(e){return{isAuthenticated:!!e.auth.token}}),(function(e){return{isToken:function(){return e({type:P})}}}))(ye)),Se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,95)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))},ke=n(20),Ee=n(47),Te={token:null,success:!1,isError:!1,loading:!1},Ue={data:[],loading:!0,isErorr:!1},we={direction:"asc"},Le={isFormValid:!1,touchedButton:!1,inputControls:{username:$("text","Username","Enter username"),password:$("password","Password","Enter password")}},Ne=Object(ke.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return Object(O.a)(Object(O.a)({},e),{},{loading:!0});case I:return Object(O.a)(Object(O.a)({},e),{},{token:t.token,success:!0,isError:!1,loading:!1});case R:return Object(O.a)(Object(O.a)({},e),{},{success:!1,isError:!0,loading:!1});case B:return Object(O.a)(Object(O.a)({},e),{},{token:null});case P:return Object(O.a)(Object(O.a)({},e),{},{token:localStorage.getItem("token")});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(O.a)(Object(O.a)({},e),{},{loading:!0});case D:return Object(O.a)(Object(O.a)({},e),{},{data:t.data,loading:!1});case V:return Object(O.a)(Object(O.a)({},e),{},{isError:!0});default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:return t.search;default:return e}},filter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(O.a)(Object(O.a)({},e),{},{direction:t.order});default:return e}},form:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(O.a)(Object(O.a)({},e),{},{isFormValid:t.isFormValid,inputControls:t.inputControls});case J:return Object(O.a)(Object(O.a)({},e),{},{touchedButton:t.touchedButton});default:return e}}}),Ae=Object(ke.e)(Ne,Object(ke.d)(Object(ke.a)(Ee.a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e}));c.a.render(Object(r.jsx)(s.a,{store:Ae,children:Object(r.jsx)(i.a,{children:Object(r.jsx)(Ce,{})})}),document.getElementById("root")),Se()}},[[79,1,2]]]);
//# sourceMappingURL=main.07fe65c3.chunk.js.map